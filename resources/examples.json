[
  {
    "question": "show orders between 01/09/2025 and 27/09/2025",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(tracking_orders.ordered_date, 'YYYY-MM-DD') as ordered_date_formatted, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date_formatted FROM orders INNER JOIN order_details ON orders.order_id = order_details.order_id INNER JOIN tracking_orders ON order_details.order_id = tracking_orders.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.ordered_date BETWEEN '2025-09-01' AND '2025-09-27' ORDER BY tracking_orders.ordered_date DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tags": "order list"
  },
  {
    "question": "show all orders",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END,'DD Mon YYYY') as expected_delivery_date,tracking_orders.last_updated_time,tracking_orders.sla_breach,TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date,TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date,TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.current_order_status != 'CHANNEL_ORDER' ORDER BY tracking_orders.ordered_date DESC,tracking_orders.ordered_time DESC,order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show all delivered orders",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END, 'DD Mon YYYY') as expected_delivery_date,tracking_orders.last_updated_time,tracking_orders.sla_breach,TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date,TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date,TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.current_order_status = 'DELIVERED' ORDER BY tracking_orders.ordered_date DESC,tracking_orders.ordered_time DESC,order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show all RTO orders",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END,'DD Mon YYYY') as expected_delivery_date, tracking_orders.last_updated_time, tracking_orders.sla_breach, TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date, TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.current_order_status IN ('RTO', 'RTO IN TRANSIT', 'RTO DELIVERED') ORDER BY tracking_orders.ordered_date DESC, tracking_orders.ordered_time DESC, order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show orders from past 7 days",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END,'DD Mon YYYY') as expected_delivery_date, tracking_orders.last_updated_time, tracking_orders.sla_breach, TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date, TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.current_order_status != 'CHANNEL_ORDER' AND tracking_orders.ordered_date >= CURRENT_DATE - INTERVAL '7 days' AND tracking_orders.ordered_date < CURRENT_DATE ORDER BY tracking_orders.ordered_date DESC, tracking_orders.ordered_time DESC, order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show orders from past month",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END,'DD Mon YYYY') as expected_delivery_date, tracking_orders.last_updated_time, tracking_orders.sla_breach, TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date, TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.current_order_status != 'CHANNEL_ORDER' AND tracking_orders.ordered_date >= CURRENT_DATE - INTERVAL '1 month' AND tracking_orders.ordered_date < CURRENT_DATE ORDER BY tracking_orders.ordered_date DESC, tracking_orders.ordered_time DESC, order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show undelivered orders from past month",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END, 'DD Mon YYYY') as expected_delivery_date, tracking_orders.last_updated_time, tracking_orders.sla_breach, TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date, TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.current_order_status = 'UNDELIVERED' AND tracking_orders.ordered_date >= CURRENT_DATE - INTERVAL '1 month' AND tracking_orders.ordered_date < CURRENT_DATE ORDER BY tracking_orders.ordered_date DESC, tracking_orders.ordered_time DESC, order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show undelivered orders from past 7 days",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END, 'DD Mon YYYY') as expected_delivery_date, tracking_orders.last_updated_time, tracking_orders.sla_breach, TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date, TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.current_order_status = 'OUT FOR DELIVERY' AND tracking_orders.ordered_date >= CURRENT_DATE - INTERVAL '7 days' AND tracking_orders.ordered_date < CURRENT_DATE ORDER BY tracking_orders.ordered_date DESC, tracking_orders.ordered_time DESC, order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show out for delivery orders from past 7 days",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END, 'DD Mon YYYY') as expected_delivery_date, tracking_orders.last_updated_time, tracking_orders.sla_breach, TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date, TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.current_order_status = 'OUT FOR DELIVERY' AND tracking_orders.ordered_date >= CURRENT_DATE - INTERVAL '7 days' AND tracking_orders.ordered_date < CURRENT_DATE ORDER BY tracking_orders.ordered_date DESC, tracking_orders.ordered_time DESC, order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show ready for pickup orders from today",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END, 'DD Mon YYYY') as expected_delivery_date, tracking_orders.last_updated_time, tracking_orders.sla_breach, TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date, TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.current_order_status = 'ORDERED' AND tracking_orders.ordered_date = CURRENT_DATE ORDER BY tracking_orders.ordered_date DESC, tracking_orders.ordered_time DESC, order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show cod orders from past 30 days",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END, 'DD Mon YYYY') as expected_delivery_date, tracking_orders.last_updated_time, tracking_orders.sla_breach, TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date, TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.current_order_status != 'CHANNEL_ORDER' AND tracking_orders.ordered_date >= CURRENT_DATE - INTERVAL '30 days' AND tracking_orders.ordered_date < CURRENT_DATE AND order_details.order_type = 'COD' ORDER BY tracking_orders.ordered_date DESC, tracking_orders.ordered_time DESC, order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show in transit prepaid orders from past 7 day",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END, 'DD Mon YYYY') as expected_delivery_date_formatted, TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date_formatted, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date_formatted, TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date_formatted FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.ordered_date >= CURRENT_DATE - INTERVAL '7 days' AND tracking_orders.ordered_date < CURRENT_DATE AND tracking_orders.current_order_status IN ('PICKED UP', 'IN TRANSIT') AND order_details.order_type = 'PREPAID' ORDER BY tracking_orders.ordered_date DESC, tracking_orders.ordered_time DESC, order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show rto orders from delhivery carrier from the past 30 days",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END, 'DD Mon YYYY') as expected_delivery_date_formatted, TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date_formatted, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date_formatted, TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date_formatted FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.ordered_date >= CURRENT_DATE - INTERVAL '30 days' AND tracking_orders.ordered_date < CURRENT_DATE AND tracking_orders.current_order_status IN ('RTO', 'RTO IN TRANSIT', 'RTO DELIVERED') AND tracking_orders.carrier_name = 'Delhivery' ORDER BY tracking_orders.ordered_date DESC, tracking_orders.ordered_time DESC, order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show in transit and out for delivery orders from delhivery and blue dart carriers from the past 7 days",
    "sql_query": "SELECT orders.*, order_details.*, tracking_orders.*, TO_CHAR(CASE WHEN tracking_orders.expected_delivery_date::text NOT IN ('DRAFTORDER', 'HYPERLOCAL_CONVERTED') THEN tracking_orders.expected_delivery_date::date ELSE NULL END, 'DD Mon YYYY') as expected_delivery_date_formatted, TO_CHAR(tracking_orders.ordered_date, 'DD Mon YYYY') as ordered_date_formatted, TO_CHAR(tracking_orders.last_updated_date, 'YYYY-MM-DD') as last_updated_date_formatted, TO_CHAR(tracking_orders.pickup_date::date, 'DD Mon YYYY') as pickup_date_formatted FROM tracking_orders INNER JOIN orders ON tracking_orders.order_id = orders.order_id INNER JOIN order_details ON orders.order_id = order_details.order_id WHERE orders.user_id = 'f17d6407-9d6b-45f5-854c-30a43b4b9615' AND tracking_orders.ordered_date >= CURRENT_DATE - INTERVAL '7 days' AND tracking_orders.ordered_date < CURRENT_DATE AND tracking_orders.current_order_status IN ('PICKED UP', 'IN TRANSIT', 'OUT FOR DELIVERY') AND tracking_orders.carrier_name IN ('Delhivery', 'Blue Dart') ORDER BY tracking_orders.ordered_date DESC, tracking_orders.ordered_time DESC, order_details.original_order_id DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["orders", "order_details", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show carrier wise order count for user from past 7 days",
    "sql_query": "SELECT orders.carrier, COUNT(tracking_orders.awbno) AS awbno_count FROM tracking_orders JOIN orders ON orders.order_id = tracking_orders.order_id WHERE orders.user_id = 'fba993c5-c349-4e17-a29b-41e9bd14ec04' AND tracking_orders.current_order_status NOT IN ('CANCELLED', 'CANCELLED NEW ORDERS', 'CHANNEL_ORDER') AND tracking_orders.awbno != 'DRAFTORDER' AND tracking_orders.ordered_date >= CURRENT_DATE - INTERVAL '7 days' AND tracking_orders.ordered_date < CURRENT_DATE GROUP BY orders.carrier ORDER BY orders.carrier;",
    "db_name": "productiondb",
    "table_names": ["orders", "tracking_orders"],
    "tag": "order list"
  },
  {
    "question": "show pincode wise delivery rate",
    "sql_query": "SELECT od.customer_pincode, o.carrier, COUNT(*) FILTER (WHERE LOWER(t.current_order_status) = 'delivered') AS delivered_count, COUNT(*) FILTER (WHERE LOWER(t.current_order_status) IN ('rto delivered','rto','rto in transit')) AS returned_count, COUNT(*) FILTER (WHERE LOWER(t.current_order_status) IN ('delivered','rto delivered','rto','rto in transit')) AS total_count, ROUND(COUNT(*) FILTER (WHERE LOWER(t.current_order_status) = 'delivered')::numeric / NULLIF(COUNT(*) FILTER (WHERE LOWER(t.current_order_status) IN ('delivered','rto delivered','rto','rto in transit')), 0), 4) AS delivery_rate FROM tracking_orders t JOIN order_details od ON t.order_id = od.order_id JOIN orders o ON t.order_id = o.order_id WHERE LOWER(t.current_order_status) IN ('delivered','rto delivered','rto','rto in transit') AND od.customer_pincode ~ '^[0-9]{6}$' AND o.user_id = 'fba993c5-c349-4e17-a29b-41e9bd14ec04' GROUP BY od.customer_pincode, o.carrier ORDER BY od.customer_pincode, delivery_rate DESC LIMIT 60;",
    "db_name": "productiondb",
    "table_names": ["od", "o", "t"],
    "tag": "pincode rate"
  }
]